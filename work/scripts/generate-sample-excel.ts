// scripts/generate-sample-excel.ts
import * as XLSX from "xlsx"
import { writeFileSync } from "fs"
import { resolve } from "path"

// 샘플 거래 데이터
const sampleTransactions = [
  {
    거래일자: "2025-10-01",
    가맹점명: "스타벅스 강남점",
    이용금액: "5,500",
    카드명: "삼성카드",
    메모: "아메리카노",
  },
  {
    거래일자: "2025-10-01",
    가맹점명: "GS25 편의점",
    이용금액: "8,200",
    카드명: "삼성카드",
    메모: "간식",
  },
  {
    거래일자: "2025-10-02",
    가맹점명: "지하철",
    이용금액: "1,400",
    카드명: "삼성카드",
    메모: "출퇴근",
  },
  {
    거래일자: "2025-10-03",
    가맹점명: "쿠팡",
    이용금액: "24,900",
    카드명: "현대카드",
    메모: "생활용품",
  },
  {
    거래일자: "2025-10-03",
    가맹점명: "올리브영",
    이용금액: "15,600",
    카드명: "현대카드",
    메모: "화장품",
  },
  {
    거래일자: "2025-10-04",
    가맹점명: "이마트",
    이용금액: "68,400",
    카드명: "삼성카드",
    메모: "주간 장보기",
  },
  {
    거래일자: "2025-10-05",
    가맹점명: "넷플릭스",
    이용금액: "13,500",
    카드명: "현대카드",
    메모: "월 구독료",
  },
  {
    거래일자: "2025-10-05",
    가맹점명: "카카오T 택시",
    이용금액: "12,800",
    카드명: "삼성카드",
    메모: "퇴근",
  },
  {
    거래일자: "2025-10-06",
    가맹점명: "파리바게뜨",
    이용금액: "7,200",
    카드명: "삼성카드",
    메모: "빵",
  },
  {
    거래일자: "2025-10-07",
    가맹점명: "CGV 영화관",
    이용금액: "28,000",
    카드명: "현대카드",
    메모: "영화 관람",
  },
  {
    거래일자: "2025-10-08",
    가맹점명: "교보문고",
    이용금액: "34,500",
    카드명: "삼성카드",
    메모: "도서 구매",
  },
  {
    거래일자: "2025-10-09",
    가맹점명: "SK텔레콤",
    이용금액: "55,000",
    카드명: "자동이체",
    메모: "월 통신비",
  },
  {
    거래일자: "2025-10-10",
    가맹점명: "아웃백",
    이용금액: "48,000",
    카드명: "현대카드",
    메모: "저녁 식사",
  },
  {
    거래일자: "2025-10-11",
    가맹점명: "스타벅스 역삼점",
    이용금액: "6,500",
    카드명: "삼성카드",
    메모: "카페라떼",
  },
  {
    거래일자: "2025-10-12",
    가맹점명: "CU 편의점",
    이용금액: "4,200",
    카드명: "삼성카드",
    메모: "간식",
  },
]

// 엑셀 파일 생성
const worksheet = XLSX.utils.json_to_sheet(sampleTransactions)

// 컬럼 너비 설정
worksheet["!cols"] = [
  { wch: 12 }, // 거래일자
  { wch: 20 }, // 가맹점명
  { wch: 12 }, // 이용금액
  { wch: 12 }, // 카드명
  { wch: 30 }, // 메모
]

const workbook = XLSX.utils.book_new()
XLSX.utils.book_append_sheet(workbook, worksheet, "거래내역")

// 파일 저장
const outputPath = resolve(__dirname, "../public/sample-card-statement.xlsx")
const buffer = XLSX.write(workbook, { type: "buffer", bookType: "xlsx" })
writeFileSync(outputPath, buffer)

console.log("✅ Sample Excel file created:", outputPath)
console.log(`📊 ${sampleTransactions.length} transactions included`)
